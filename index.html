<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Basic Example with JSX</title>
<link rel="stylesheet" href="./cmdline.css">
<link rel="stylesheet" href="../shared/css/base.css" />
</head>
<body>
<h1>Basic Example with JSX</h1>
<div id="container">
<p>
To install React, follow the instructions on
<a href="https://github.com/facebook/react/">GitHub</a>.
</p>
<p>
If you can see this, React is <strong>not</strong> working right.
If you checked out the source from GitHub make sure to run <code>grunt</code>.
</p>
</div>
<h4>Example Details</h4>
<p>This is written with JSX and transformed in the browser.</p>
<p>
Learn more about React at
<a href="https://facebook.github.io/react" target="_blank">facebook.github.io/react</a>.
</p>
<div id="moongenlog">
Dummylog
</div>
<script src="./react.js"></script>
<script src="./react-dom.js"></script>
<script src="./browser.min.js"></script>
<script type="text/babel">

//sample
var ExampleApplication = React.createClass({
render: function() {
var elapsed = Math.round(this.props.elapsed  / 100);
var seconds = elapsed / 10 + (elapsed % 10 ? '' : '.0' );
var message =
'React has been successfully running for ' + seconds + ' seconds.';

return <p>{message}</p>;
}
});
var start = new Date().getTime();
/*
setInterval(function() {
		ReactDOM.render(
			<ExampleApplication elapsed={new Date().getTime() - start} />,
			document.getElementById('container')
			);
		}, 50);
*/

//ajax
var UserGist = React.createClass({
	getInitialState: function() {
		return {
			log: ''
		};
	},

	update() {
		console.log("here");
		console.log(this.props.source);
		fetch(this.props.source)
		.then((response) => response.json())
		.then((responseText) => {
			var logText = responseText.log;
			console.log(logText);
			this.setState({
				log: logText
			})
		})
		.catch((error) => {
			console.warn(error);
		});
	},

	componentDidMount: function() {
		setInterval(this.update(), 250);
	},

	render: function() {
		return (
				<pre dangerouslySetInnerHTML={{__html: this.state.log}} />
		       );
	}
});

setInterval(function() {
		ReactDOM.render(
			<UserGist source="http://localhost:8080/log/bla" />,
			document.getElementById('moongenlog') 
		);
	}, 250);	
</script>
</body>
</html>
